---

- name: push resolv.conf
  template: >
   src=etc/resolv.conf.j2
   dest=/etc/resolv.conf
   mode=0644
   owner=0
   group=0
   backup=yes
  tags: ['resolv']

- name: copy systemd-networkd files
  copy: >
    src=etc/systemd/network/
    dest=/etc/systemd/network/
    mode=0644
    owner=0
    group=0
    backup=yes
  tags: ['networkd']

- name: push systemd-networkd wireless config
  template: >
   src=etc/systemd/network/90-wifi.network.j2
   dest=/etc/systemd/network/90-wifi.network
   mode=0644
   owner=0
   group=0
   backup=yes
  tags: ['networkd']

- name: disable NetworkManager service
  systemd: enabled=no state=stopped name=NetworkManager
  ignore_errors: yes

- name: enable networkd service
  systemd: enabled=yes state=started name=systemd-networkd

#- name: enable resolved service
#  systemd: enabled=no state=stopped daemon_reload=yes name=systemd-resolved
#  tags: ['resolvd']
